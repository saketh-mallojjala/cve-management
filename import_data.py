import csv
import sqlite3


csv_file_path = 'CVE_DATABASE.csv'

database_path = 'cve_database.db'


conn = sqlite3.connect(database_path)
cursor = conn.cursor()


cursor.execute('''
CREATE TABLE IF NOT EXISTS cve (
    cve_id TEXT PRIMARY KEY,
    severity TEXT,
    cvss REAL,
    affected_packages TEXT,
    description TEXT,
    cwe_id TEXT
)
''')


with open(csv_file_path, newline='') as csvfile:
    csv_reader = csv.DictReader(csvfile)
    for row in csv_reader:
        cursor.execute('''
        INSERT OR IGNORE INTO cve (cve_id, severity, cvss, affected_packages, description, cwe_id)
        VALUES (?, ?, ?, ?, ?, ?)
        ''', (row['CVE-ID'], row['Severity'], row['CVSS'], row['Affected Packages'], row['Description'], row['CWE-ID']))


conn.commit()
conn.close()
